(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{287:function(t,e,s){"use strict";s.r(e);var i,n=s(12),o=s(21);class h{constructor(...t){2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]?this.set(t[0],t[1]):1===t.length&&t[0]instanceof h?this.set(t[0]):this.set(0,0)}set(...t){let e=0,s=0;1===t.length?t[0]instanceof h&&(e=t[0].x,s=t[0].y):2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]&&(e=t[0],s=t[1]),this.x=e,this.y=s}scale(t){return this.x*=t,this.y*=t,this}add(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}getDistance(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))}getCenter(t){return new h((this.x+t.x)/2,this.y/t.y/2)}static scale(t,e){const s=new h(t);return s.scale(e),s}static add(t,e){const s=new h(t);return s.add(e),s}static subtract(t,e){const s=new h(t);return s.subtract(e),s}}class r extends class{constructor(t){this.position=new h(t)}setPosition(...t){2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1]?this.position.set(t[0],t[1]):1===t.length&&t[0]instanceof h&&this.position.set(t[0])}getPosition(){return this.position}getX(){return this.position.x}getY(){return this.position.y}}{constructor(t,e,s){super(t),this.width=e,this.height=s}setDimensions(t,e){this.width=t,this.height=e}setWidth(t){this.width=t}setHeight(t){this.height=t}getWidth(){return this.width}getHeight(){return this.height}isPointInside(t){return t.x>=this.position.x&&t.x<=this.position.x+this.width&&t.y>=this.position.y&&t.y<=this.position.y+this.height}}!function(t){t[t.LEFT=0]="LEFT",t[t.MIDDLE=1]="MIDDLE",t[t.RIGHT=2]="RIGHT"}(i||(i={}));class a{constructor(){this.mousePosition=new h,this.mouseButtons={LEFT:!1,MIDDLE:!1,RIGHT:!1},this.keys={},this.wheel=0,this.doubleClicked=!1,this.propagate=!0}static GetInstance(){return a.instance||(a.instance=new a),a.instance}getMousePosition(){return this.mousePosition}getMouseButtons(){return this.propagate?this.mouseButtons:{LEFT:!1,MIDDLE:!1,RIGHT:!1}}getKeys(){return this.keys}getWheel(){return this.wheel}getDoubleClicked(){return this.doubleClicked}stopPropagation(){this.propagate=!1}restoreState(){this.wheel=0,this.doubleClicked=!1,this.propagate=!0}onPointerMove(t){t.preventDefault();const e=t.currentTarget.getBoundingClientRect();this.mousePosition.set((t.clientX-e.left)*(t.currentTarget.width/e.width),(t.clientY-e.top)*(t.currentTarget.height/e.height))}onPointerDown(t){switch(t.preventDefault(),t.button){case i.LEFT:this.mouseButtons.LEFT=!0;break;case i.MIDDLE:this.mouseButtons.MIDDLE=!0;break;case i.RIGHT:this.mouseButtons.RIGHT=!0}}onPointerUp(t){switch(t.preventDefault(),t.button){case i.LEFT:this.mouseButtons.LEFT=!1;break;case i.MIDDLE:this.mouseButtons.MIDDLE=!1;break;case i.RIGHT:this.mouseButtons.RIGHT=!1}}onPointerEnter(t){t.preventDefault()}onPointerLeave(t){t.preventDefault(),this.mousePosition.set(-1,-1),this.mouseButtons={LEFT:!1,MIDDLE:!1,RIGHT:!1}}onDoubleClick(t){t.preventDefault(),this.doubleClicked=!0}onWheel(t){t.preventDefault(),this.wheel=t.deltaY}onKeyDown(t){t.preventDefault(),console.log(t.key),this.keys[t.key]=!0}onKeyUp(t){t.preventDefault(),this.keys[t.key]=!1}}var c=a.GetInstance();class g{constructor(t=!0,e=!1){this.visible=t,this.draggable=e,this.active=!1}setVisible(t){this.visible=t}setDraggable(t){this.draggable=t}getVisible(){return this.visible}getDraggable(){return this.draggable}update(t){const e=w.screenToWorld(c.getMousePosition()),s=c.getMouseButtons().LEFT;if(this.active)if(s){const t=this.getRect();this.setPosition(new h(e.x-t.getWidth()/2,e.y-t.getHeight()/2)),c.stopPropagation()}else this.active=!1,console.log(this.getRect());this.visible&&this.draggable&&s&&this.getRect().isPointInside(e)&&(this.active=!0,c.stopPropagation())}}class l extends g{constructor(t,e,s,i,n,o){super(n,o);const a=w.getImages().get(t);this.image=void 0!==a?a:new Image,this.srcRect=void 0!==e?e:new r(new h,this.image.width,this.image.height),this.dstRect=void 0!==s?s:new r(new h,this.image.width,this.image.height),this.scale=void 0!==i?i:new h(1,1)}setRects(t,e){this.srcRect=void 0!==t?t:new r(new h,this.image.width,this.image.height),this.dstRect=void 0!==e?e:new r(new h,this.image.width,this.image.height)}setSourceRect(t){this.srcRect=void 0!==t?t:new r(new h,this.image.width,this.image.height)}setDestinationRect(t){this.dstRect=void 0!==t?t:new r(new h,this.image.width,this.image.height)}setPosition(t){this.dstRect.setPosition(t.x,t.y)}getSourceRect(){return this.srcRect}getRect(){return this.dstRect}render(){if(this.visible){const t=w.getContext();t.save(),t.scale(this.scale.x,this.scale.y),t.drawImage(this.image,this.srcRect.getX(),this.srcRect.getY(),this.srcRect.getWidth(),this.srcRect.getHeight(),this.dstRect.getX(),this.dstRect.getY(),this.dstRect.getWidth(),this.dstRect.getHeight()),w.getDebug()&&(t.save(),t.strokeStyle="red",t.strokeRect(this.dstRect.getX(),this.dstRect.getY(),this.dstRect.getWidth(),this.dstRect.getHeight()),t.restore()),t.restore()}}}var u=s(19),d=s(50);class p{constructor(){this.debug=!1,this.images=new Map,this.loaded=0,this.offset=new h,this.scale=new h(1,1),this.players=new Map}static GetInstance(){return p.instance||(p.instance=new p),p.instance}setDebug(t){this.debug=t}setContext(t){this.context=t}setTheme(t){this.theme=t}setImages(t){for(let e=0;e<t.length;e+=2){const s=new Image;this.images.set(t[e],s),s.src=t[e+1],s.onload=()=>{this.loaded++}}}setOffset(t,e){this.offset.set(t,e)}setScale(t,e){this.scale.set(t,e)}getDebug(){return this.debug}getContext(){return this.context}getImages(){return this.images}getTheme(){return this.theme}getOffset(){return this.offset}getScale(){return this.scale}getPlayers(){return this.players}isLoaded(){return this.loaded===this.images.size}screenToWorld(t){const e=h.add(t,this.offset);return e.x/=this.scale.x,e.y/=this.scale.y,e}updatePlayers(){const t=d.a.getState(),e=Object(u.c)(t),s=Object(n.d)(t),i=Object(n.h)(t);for(const t of Object.keys(e)){const n=e[t];let a=o.b[t].alive,c=!0,g=!0;n.section===s?a=o.b[t].dead:n.section===i&&(c=!1,g=!1);const u=new r(new h(a.x,a.y),a.w,a.h);if(this.players.has(t)){const e=this.players.get(t);if(void 0!==e){const s=e.getRect(),i=e.getSourceRect();s.getWidth()===i.getWidth()&&s.getHeight()===i.getHeight()&&(e.setDestinationRect(new r(s.getPosition(),u.getWidth(),u.getHeight())),console.log(t+" - setting dstrect")),console.log(`${t} - ${s.getWidth()} === ${i.getWidth()} - ${u.getWidth()}`),e.setSourceRect(u),e.setVisible(c),e.setDraggable(g)}}else this.players.set(t,new l("Players",u,void 0,void 0,c,g))}}}var w=p.GetInstance();class f{constructor(t=!0){this.entities=[],this.visible=t}setVisible(t){this.visible=t}getVisible(){return this.visible}update(t){for(let e=this.entities.length-1;e>=0;e--)this.entities[e].update(t)}render(){if(this.visible)for(const t of this.entities)t.render()}}new h(1150,6689),new h(3690,475),new h(3927,574);const y={x:0,y:0,w:208,h:45},m={x:612,y:0,w:144,h:45},x={x:416,y:0,w:196,h:42},b={x:208,y:0,w:208,h:45},v=756,S=0,P=45,R=45;class D{constructor(){this.layers=[]}update(t){for(let e=this.layers.length-1;e>=0;e--)this.layers[e].update(t)}render(){const t=w.getContext(),e=t.canvas.width,s=t.canvas.height;t.clearRect(0,0,e,s);const i=w.getOffset(),n=w.getScale();t.save(),t.translate(-i.x,-i.y),t.scale(n.x,n.y);for(const t of this.layers)t.render();t.restore()}}class I{constructor(){this.scenes=new Map,this.currentScene=""}static GetInstance(){return I.instance||(I.instance=new I),I.instance}addScene(t,e){this.scenes.set(t,e)}delScene(t){this.scenes.delete(t)}changeScene(t){var e,s;if(!this.scenes.has(t))throw new Error(t+" no such a scene.");""!==this.currentScene&&(null===(e=this.scenes.get(this.currentScene))||void 0===e||e.onExit()),null===(s=this.scenes.get(t))||void 0===s||s.onEnter(),this.currentScene=t}getCurrentScene(){return this.currentScene}update(t){const e=this.scenes.get(this.currentScene);void 0!==e&&e.update(t)}render(){const t=this.scenes.get(this.currentScene);void 0!==t&&t.render()}}var M=I.GetInstance();class T extends g{constructor(t,e,s=!0,i=20,n="black",o="white",a=8,c,g){super(c,g),this.text=t,this.position=e,this.center=s,this.fontSize=i,this.strokeStyle=n,this.fillStyle=o,this.lineWidth=a,this.rect=new r(new h,0,i),this.setRect()}setPosition(t){this.position.set(t),this.center&&this.position.set(t.x+this.rect.getWidth()/2,t.y+this.rect.getHeight()/2);let e=this.position.x,s=this.position.y;this.center&&(e-=this.rect.getWidth()/2,s-=this.fontSize/2),this.rect.setPosition(e,s)}setText(t){this.text=t,this.setRect()}getPosition(){return this.position}getRect(){return this.rect}render(){const t=w.getContext();""!=this.text&&this.visible&&(t.save(),t.textBaseline="top",this.center&&(t.textBaseline="middle",t.textAlign="center"),t.font=`${this.fontSize}px ${w.getTheme().fontFamily}`,t.strokeStyle=this.strokeStyle,t.fillStyle=this.fillStyle,t.lineWidth=this.lineWidth,t.strokeText(this.text,this.position.x,this.position.y),t.fillText(this.text,this.position.x,this.position.y),w.getDebug()&&(t.strokeStyle="red",this.center&&(t.fillStyle="red",t.beginPath(),t.arc(this.position.x,this.position.y,this.lineWidth,0,2*Math.PI),t.fill()),t.strokeRect(this.rect.getX(),this.rect.getY(),this.rect.getWidth(),this.rect.getHeight())),t.restore())}setRect(){const t=w.getContext();t.save(),t.font=`${this.fontSize}px ${w.getTheme().fontFamily}`;const e=t.measureText(this.text).width;t.restore();let s=this.position.x,i=this.position.y;this.center&&(s-=e/2,i-=this.fontSize/2),this.rect.setPosition(s,i),this.rect.setWidth(e)}}class E extends D{constructor(){super();const t=new f;t.entities.push(new T("Choose a map:",new h(960,400),!0,60)),t.entities.push(new l("Logos",new r(new h(y.x,y.y),y.w,y.h),new r(new h(700,500),200,45))),t.entities.push(new l("Logos",new r(new h(m.x,m.y),m.w,m.h),new r(new h(1e3,500),200,45))),t.entities.push(new l("Logos",new r(new h(x.x,x.y),x.w,x.h),new r(new h(700,600),200,45))),t.entities.push(new l("Logos",new r(new h(b.x,b.y),b.w,b.h),new r(new h(1e3,600),200,45))),this.layers.push(t)}onEnter(){w.setOffset(0,0),w.setScale(1,1)}onExit(){}update(){if(c.getMouseButtons().LEFT){const t=c.getMousePosition(),e=this.layers[0].entities;for(let s=1;s<e.length;s++){if(e[s].getRect().isPointInside(t)){switch(s){case 1:M.changeScene("MiraHQ");break;case 2:M.changeScene("Polus");break;case 3:M.changeScene("TheSkeld");break;default:M.changeScene("TheAirship")}break}}}}}class k extends D{constructor(t,e){super(),this.panning=!1,this.panningPosition=new h;const s=new f;s.entities.push(new l(t,void 0,void 0,new h(e,e))),this.layers.push(s),this.offset=new h(0,0),this.scale=new h(0,0),this.hub=new f,this.hub.entities.push(new l("Logos",new r(new h(v,S),P,R),new r(new h(1900-P,20),P,R)));const i=w.getContext(),n=i.canvas.width,o=i.canvas.height,a=w.getImages().get(t);null!=a&&(this.scale.x=n/(a.width*e),this.scale.y=o/(a.height*e))}onEnter(){w.setOffset(this.offset.x,this.offset.y),w.setScale(this.scale.x,this.scale.y)}onExit(){this.offset.set(w.getOffset()),this.scale.set(w.getScale())}update(t){const e=c.getMousePosition();this.panning&&c.getMouseButtons().LEFT&&(w.getOffset().subtract(h.subtract(e,this.panningPosition)),this.panningPosition.set(e),c.stopPropagation()),super.update(t),c.getMouseButtons().LEFT?this.hub.entities[0].getRect().isPointInside(e)?(M.changeScene("Menu"),c.stopPropagation()):(this.panning=!0,this.panningPosition.set(e)):this.panning=!1;const s=c.getWheel();if(s){const t=w.screenToWorld(e);s>0?(w.getScale().x*=.9,w.getScale().y*=.9):s<0&&(w.getScale().x*=1.1,w.getScale().y*=1.1);const i=w.screenToWorld(e);t.subtract(i),t.x*=w.getScale().x,t.y*=w.getScale().y,w.getOffset().add(t)}c.getKeys().M&&M.changeScene("Menu"),c.restoreState()}render(){super.render(),this.hub.render()}}class H extends k{constructor(){super("MiraHQ",2)}}class L extends D{constructor(){super(),w.setImages(["MiraHQ","assets/images/MiraHQ.png","Polus","assets/images/Polus.png","TheSkeld","assets/images/TheSkeld.png","Players","assets/images/players.png","Logos","assets/images/logos.png"]);const t=w.getContext(),e=new f;e.entities.push(new T("Loading...",new h(t.canvas.width/2,t.canvas.height/2-50),!0,100)),e.entities.push(new T("fusliez notes created by the fuslie family",new h(t.canvas.width/2,t.canvas.height/2+50),!0,20)),this.layers.push(e)}onEnter(){}onExit(){}update(){w.isLoaded()&&(M.addScene("Menu",new E),M.addScene("MiraHQ",new H),M.changeScene("Menu"))}}class C{constructor(){this.animFrame=0}static GetInstance(){return C.instance||(C.instance=new C),C.instance}getAnimFrame(){return this.animFrame}init(){const t=w.getContext(),e=w.getTheme();if(void 0===t&&null===t||void 0===e&&null===e)throw new Error("Context and theme must be set before initializing the animation.");M.addScene("Loading",new L),M.changeScene("Loading"),this.loop(0)}update(t){M.update(t)}render(){M.render()}loop(t){W.update(t),W.render(),W.animFrame=window.requestAnimationFrame(W.loop)}}const W=C.GetInstance();var F={Main:W,Config:w,InputHandler:c,SceneManager:M},B=s(0),G=s.n(B),O=s(31),j=s(15),z=Object(j.d)({Maps:{padding:"1rem",flexGrow:1,maxHeight:"calc((var(--vh, 1vh) * 100) - 2.2rem)",fallbacks:{maxHeight:"calc(100vh - 2.2rem)"}},MapsCanvas:{width:"100%",height:"100%",overscrollBehavior:"none",touchAction:"none"}}),K=s(22);e.default=function(){const t=z(),e=Object(K.c)(),s=Object(O.c)(u.c),i=Object(O.c)(n.e),o=Object(O.c)(n.d),h=Object(O.c)(n.h),r=G.a.useRef(null);return G.a.useEffect(()=>{if(null!==r.current){const t=r.current.getContext("2d");if(null!==t)return F.Config.setDebug(!0),F.Config.setContext(t),F.Config.setTheme(e),F.Main.init(),()=>{cancelAnimationFrame(F.Main.getAnimFrame())}}},[]),G.a.useEffect(()=>{F.Config.setTheme(e)},[e]),G.a.useEffect(()=>{F.Config.updatePlayers()},[s,i,o,h]),G.a.createElement("div",{className:t.Maps},G.a.createElement("canvas",{ref:r,width:1920,height:1080,className:t.MapsCanvas,onContextMenu:t=>t.preventDefault(),onPointerMove:t=>F.InputHandler.onPointerMove(t),onPointerDown:t=>F.InputHandler.onPointerDown(t),onPointerUp:t=>F.InputHandler.onPointerUp(t),onPointerEnter:t=>F.InputHandler.onPointerEnter(t),onPointerLeave:t=>F.InputHandler.onPointerLeave(t),onDoubleClick:t=>F.InputHandler.onDoubleClick(t),onWheel:t=>F.InputHandler.onWheel(t),onKeyDown:t=>F.InputHandler.onKeyDown(t),onKeyUp:t=>F.InputHandler.onKeyUp(t)},"This section is not supported on your browser."))}}}]);